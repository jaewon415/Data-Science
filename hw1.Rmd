Stat/QSci 403         Homework 1   Sunday April 3 11.59PM      
======================================================
-------------------------------------------------------
## See the accompanying homework_template.Rmd file

leftPointX = c(-0.5, x) 
leftPointY = c(0, x/12)

rightPointX = c(x,13.5)
rightPointY = c(0, x/12)

plot(x, pbinom(x, trial, success),type="n", xlim=c(-0.5,13.5), ylim = c(0,1),xlab="trials", ylab="CDF", main="Binomial CDF", axes=TRUE)
axis(1, at= x)
axis(2)
box()
segments(leftPointX, leftPointY, rightPointX, rightPointY,lwd=2)
points(x,c(0:11)/12)

##  Create your own Markdown file named "lab1_solutions.Rmd" with R code chunks corresponding to the lab exercise solutions. Add some text so it is clear what the chunks mean.
# read.table returns data.frame object, which is a table with special properties
```{r}
injury.counts = read.table("http://faculty.washington.edu/harin/StatQSci403/accident_injury.txt", header = TRUE)

``` 
1. Using car accidents/injuries data from lab 1, create a new data frame that contains the two original columns and a third column containing frequencies of accidents with 0, 1, 2, . . . , 6. Display the new data frame in the markdown/html.

I added up all the number of injuries, and then divided that number by each number of injury in each row to find the frequencies of accidents in the third column.
```{r}
addCounts = sum(injury.counts$Counts)
frequenciesOfAccidents = c(injury.counts$Counts / addCounts)
injury_df <- data.frame(injury.counts, frequenciesOfAccidents)
print(injury_df)
```

2.Rename the columns of the data frame injury.counts to "InjuriesPerAccident" and "InjuryCounts"
## Hint: look up the help file for function "colnames"

I switched up the label of the columns.
```{r}
colnames(injury_df) <- c("InjuriesPerAccident", "InjuryCounts", "frequenciesOfAccidents")
```

3. Define a new data frame injury.new that only includes rows with injury counts greater than zero.
## Hint: If you are stuck, check out the "which" function and look at the examples

The "positive.count" basically sets up the criteria for natural numbers that is bigger than 0, and changes the data frame with its new qualification. 
```{r}
positive.count <- which(injury_df$InjuryCounts > 0)
injury.new <- data.frame(injury_df[positive.count,])
print(injury.new)
```

4. Compute the empirical variance of the number of injuries
## Hint: use either the definition of the variance or the formula involving the first and second moment


```{r}
injury <- injury.counts[,1]
counts <- injury.counts[,2]
emp.mean = sum(injury * counts)/ sum(counts)
emp.var = sum((injury - emp.mean)^2 * counts) / sum(counts)
```

5. Plot the probability mass function and cdf of the following distributions.
 ( a ) A distribution of a random variable X that records the number of injuries in a given car accident. Assume that X E {0, 1, 2, . . . , 6} and use frequencies from question 1 as probabilities for the number of injuries.
 




 
 ( b ) Binomial distribution with 12 trials and probability of "success" $p=0.3$.  

x <- c(1:12)
plot(x, dbinom(x, 12, 0.3))


 
 ( c ) Exponential distribution with rate $\lambda= 0.3$. Use [0, 30] as your x-axis range.  

 